---
title: "Why I like functional programming: F#, Mandelbrot and more WPF"
date: 2006-08-08T12:34:00.0000000
draft: false
---

<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">I was playing around with implementing drawing a Mandelbrot set in F#. F# makes this very easy because of its Microsoft.FSharp.Math namespace provides a very easy to use complex implementation which means you just need to type out the equation and viola you have the Mandelbrot set. Or so I thought. My implementation end up being about 40 lines about 11 of which were the equation on which the Mandelbrot set was based and the rest of the code was infrastructure to use the equation and display the results. While the resulting code, shown below, is still reasonably short this isn&#8217;t what I was hopping for.</SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Drawing<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Forms<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> Microsoft.FSharp.Math <BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c_max = Complex.one + Complex.onei<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c_min = Complex.mkRect(-1.0, -1.0) <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> iterantions = 18.0<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> is_in_mandelbrot_set x y = <BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c = ref (Complex.mkRect(x,y)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> count = ref 0.0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> const_c = !c <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">while</SPAN> (c_max &gt; !c) &amp;&amp; (!c &gt; c_min) &amp;&amp; (!count &lt; iterantions) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:=</SPAN> (!c * !c) + const_c;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:=</SPAN> !count + 1.0<BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;&nbsp;&nbsp; !count<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> intergral = 1.0 / 200.0<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> offset = -1.0<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> get_coord (x, y) =<BR>&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> fx = ((float_of_int x) * intergral) + offset <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> fy = ((float_of_int y) * intergral) + offset <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp; fx, fy<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> form = <BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> image = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Bitmap(400, 400) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> x = 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> 399 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> y = 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> 399 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> fx, fy = get_coord (x, y) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> no = is_in_mandelbrot_set fx fy <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">if</SPAN> no = iterantions <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">then</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; image.SetPixel(x,y, Color.Black)<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>; <BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> temp = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Form() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; temp.Paint.Add(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> e -&gt; e.Graphics.DrawImage(image, 0, 0))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN> <BR>&nbsp;&nbsp;&nbsp; temp&nbsp;&nbsp;&nbsp; <BR><BR>[<STATHREAD>]&nbsp;&nbsp;&nbsp; <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN> Application.Run(form)</SPAN>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">The resulting picture is pretty dull too, while this is clearly the Mandelbrot set, there are no jazzy colours and there&#8217;s no zoom.<o:p></o:p></SPAN></P>
<P><IMG src="/Blog/Photos/mandelbrot/mandelbrot1.jpg"></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">But let&#8217;s not get too down on this implementation, let look at what F# did well, the 11 lines that made up the equation that tests whether a point is part of the Mandelbrot set or not. <SPAN style="mso-spacerun: yes">&nbsp;</SPAN>So here&#8217;s the bit I like. I reasoned that as it was the infrastructure code that was taking up the space, I could import the Mandelbrot code into the infrastructure I made to show how <A href="http://strangelights.com/blog/archive/2006/06/23/1309.aspx">F# worked with WPF/Xaml</A>. All I did was copied and pasted the &#8220;is_in_mandelbrot_set&#8221; function into my cat sample. I then created a new function &#8220;map_positions_mandelbrot&#8221; that mapped the WFP class Point3DCollection to a Point3DCollection where the Z index had been altered according to the &#8220;is_in_mandelbrot_set&#8221; function, this sounds complex but using the existing infrastructure it took just two lines of code. Then it was possible to run the example and view the distinctive Mandelbrot shape mapped over a 3D plane containing a picture of my cat. Pretty neat for just 20 extra lines of code, including comments.<o:p></o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">I also added a couple of slide bars to allow the user to zoom in and out of the plane and also twist it around to view it from other angles. This was also very easy positioning the sliders on the window was done in Xaml so hidden from the F# code, then it was just a matter of attaching a two line function to the relivant event handler and the zoom and twist was taken care of.<o:p></o:p></SPAN></P>
<P><IMG src="/Blog/Photos/mandelbrot/cat_mandelbrot1.jpg"></P>
<P><IMG src="/Blog/Photos/mandelbrot/cat_mandelbrot2.jpg"></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">The full F# code is listed here:</SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Collections.Generic <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.IO<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Controls<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Markup<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Media<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Media.Media3D<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Xml<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> Microsoft.FSharp.Math <BR><BR>#I <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"C:\Program Files\Reference Assemblies\Microsoft\WinFx\v3.0"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"PresentationCore.dll"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"PresentationFramework.dll"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"WindowsBase.dll"</SPAN> ;;<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// creates the window and loads given the Xaml file into it</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_window (file : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">string</SPAN>) = <BR>&nbsp;Idioms.using&nbsp; (XmlReader.Create(file))<BR>&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> stream -&gt; <BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> temp = XamlReader.Load(stream) :?&gt; Window <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;temp.Height &lt;- 400.0;<BR>&nbsp;&nbsp;temp.Width &lt;- 400.0;<BR>&nbsp;&nbsp;temp.Title &lt;- <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"F# meets Xaml"</SPAN><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;&nbsp;temp)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// finds all the MeshGeometry3D in a given 3D view port</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> find_meshes ( viewport : Viewport3D ) = <BR>&nbsp;viewport.Children <BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> ModelVisual3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> c -&gt; Some(c.Content) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> Model3DGroup <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mg -&gt; Some(mg.Children) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.concat<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> GeometryModel3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mg -&gt; Some(mg.Geometry) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> MeshGeometry3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mv -&gt; Some(mv) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// loop function to create all items necessary for a plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_item_list f (x_res : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) (y_res : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> List&lt;_&gt;() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> x = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> x_res - 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> y = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> y_res - 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;f list x y<BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;list<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// function to initalise a point</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> point x y = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point(x, y)<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// function to initalise a "d point</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> point3D x y = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D(x, y, 0.0)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create all the points necessary for a square in the plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_square f (x_step : float) (y_step : float) (list : List&lt;_&gt;) (x : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) (y : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> x' =&nbsp; Float.of_int x * x_step <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> y' =&nbsp; Float.of_int y * y_step <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;list.Add(f x' y')<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) y')<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f x' (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f x' y')<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create all items in a plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_points f x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> x_step = 1.0 / Float.of_int x_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> y_step = 1.0 / Float.of_int y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;create_plane_item_list (create_square f x_step y_step) x_res y_res<BR>&nbsp;<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create the 3D positions for a plane, i.e. the thing that says where</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// the plane will be in 3D space</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_positions x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = create_plane_points point3D x_res y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create the texture mappings for a plane, i.e. the thing that </SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// maps the 2D image to the 3D plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_textures x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = create_plane_points point x_res y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> PointCollection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create indices list fora ll our triangles&nbsp;</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_indices_plane width height = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> System.Collections.Generic.List&lt;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>&gt;() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> index = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> width * height * 6 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;list.Add(index)<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Int32Collection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// center the plane in the field of view</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_center (positions : Point3DCollection) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> new_positions = positions |&gt; IEnumerable.map&nbsp; <BR>&nbsp;&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> position -&gt; <BR>&nbsp;&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D((position.X - 0.5 ) * -1.0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">,</SPAN> (position.Y - 0.5 ) * -1.0, position.Z)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(new_positions)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create a plane and add it to the given mesh</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> add_plane_to_mesh (mesh : MeshGeometry3D) x_res y_res = <BR>&nbsp;mesh.Positions &lt;- map_positions_center (create_plane_positions x_res y_res)<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;mesh.TextureCoordinates &lt;- create_plane_textures x_res y_res;<BR>&nbsp;mesh.TriangleIndices &lt;- create_indices_plane x_res y_res<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// generic function for mapping Z plane relative to x y plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions f (positions : Point3DCollection) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> new_positions = positions |&gt; IEnumerable.map&nbsp; <BR>&nbsp;&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> position -&gt; <BR>&nbsp;&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D(position.X, position.Y, f position.X position.Y)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(new_positions)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the y coordiante</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_cos_y = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> _ y -&gt; Math.Cos(y * Math.PI))<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the x and y coordiantes</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_cos_xy = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> x y -&gt; Math.Cos(x * Math.PI) * Math.Cos(y * Math.PI))<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the x and y coordiantes, that </SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// has been scaled to give a rippled effect</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_waves = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> x y -&gt; (Math.Cos(x * Math.PI * 4.0) / 3.0) * (Math.Cos(y * Math.PI * 2.0) / 3.0)) <BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's Z coordiante randomly</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_random = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> rand = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Random() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> _ _ -&gt; rand.NextDouble() / 10.0) <BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// constants for the mandelbrot function</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c_max = Complex.one + Complex.onei<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c_min = Complex.mkRect(-1.0, -1.0) <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> iterantions = 50.0<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> is_in_mandelbrot_set x y = <BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> c = ref (Complex.mkRect(x * 2.0, y * 2.0)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> count = ref 0.0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> const_c = !c <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">while</SPAN> (c_max &gt; !c) &amp;&amp; (!c &gt; c_min) &amp;&amp; (!count &lt; iterantions) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; c <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:=</SPAN> (!c * !c) + const_c;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; count <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:=</SPAN> !count + 1.0<BR>&nbsp;&nbsp;&nbsp; <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;&nbsp;&nbsp; !count / (iterantions * 3.0)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// the mandelbrot function itself</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_mandelbrot = <BR>&nbsp;map_positions is_in_mandelbrot_set<BR><BR>[<STATHREAD>]<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create our window</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> window = create_window <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"Window1.xaml"</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// grab the 3D view port</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> viewport = window.FindName(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"ViewPort"</SPAN>) :?&gt; Viewport3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> perspectiveCamera =&nbsp; viewport.Camera :?&gt; PerspectiveCamera <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// find the zoom slider and attach an event handler to it</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> zoom = window.FindName(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"Zoom"</SPAN>) :?&gt; Slider <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;zoom.Value &lt;- 4.0;<BR>&nbsp;zoom.ValueChanged.Add(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> e -&gt; perspectiveCamera.FieldOfView &lt;- (e.NewValue * 10.0) )<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// find the angel slider and attach an event handler to it</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> angel = window.FindName(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"Angel"</SPAN>) :?&gt; Slider <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;angel.Value &lt;- 5.0;<BR>&nbsp;angel.ValueChanged.Add(<BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> e -&gt; <BR>&nbsp;&nbsp;&nbsp;perspectiveCamera.LookDirection &lt;- <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Vector3D(0.0,(e.NewValue - 5.0) / -2.0,-1.0)<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;&nbsp;&nbsp;perspectiveCamera.Position &lt;- <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D(0.0,(e.NewValue - 5.0),2.0))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// find all the meshes and get the first one</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> meshes = find_meshes viewport <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> mesh = IEnumerable.hd meshes <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// add plane to the mesh</SPAN><BR>&nbsp;add_plane_to_mesh mesh 100 100;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// apply a transformation to the plane</SPAN><BR>&nbsp;mesh.Positions &lt;- map_positions_mandelbrot mesh.Positions;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// show the window</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> app = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Application() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;&nbsp; app.Run(window) |&gt; ignore</SPAN>&nbsp;</o:p></SPAN></P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p></o:p></SPAN>&nbsp;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">The Xaml code is here:<o:p></o:p></SPAN></P><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana"><o:p>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"></WINDOW><WINDOW<BR>&nbsp;&nbsp;&nbsp; <BR></WINDOW>&lt;Window<BR>&nbsp;&nbsp;&nbsp; <BR>xmlns="<A href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</A>"<BR>&nbsp;&nbsp;&nbsp; <BR>xmlns:x="<A href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</A>"<BR>&nbsp;&nbsp;&nbsp; Title="RichContent"<BR>&nbsp;&nbsp;&nbsp; &gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Grid&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Grid.ColumnDefinitions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ColumnDefinition Width="64" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ColumnDefinition Width="*" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Grid.ColumnDefinitions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Grid.RowDefinitions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RowDefinition Height="24"/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RowDefinition Height="24"/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RowDefinition Height="*" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Grid.RowDefinitions&gt;<BR>&nbsp; &lt;Label Grid.Row="0" Grid.Column="0" &gt;Zoom&lt;/Label&gt;<BR>&nbsp; &lt;Label Grid.Row="1" Grid.Column="0" &gt;Angel&lt;/Label&gt;<BR>&nbsp; &lt;Slider Name="Zoom" Grid.Row="0" Grid.Column="1" /&gt;<BR>&nbsp; &lt;Slider Name="Angel" Grid.Row="1" Grid.Column="1" /&gt;<BR>&nbsp; &lt;Viewport3D Name="ViewPort" Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2" &gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Camera&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;PerspectiveCamera Position="0,0,2" LookDirection="0,0,-1" FieldOfView="40" /&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Camera&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ModelVisual3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ModelVisual3D.Content&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Model3DGroup &gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Model3DGroup.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;AmbientLight Color="White" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Geometry&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;MeshGeometry3D /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Geometry&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Transform&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RotateTransform3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RotateTransform3D.Rotation&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;AxisAngleRotation3D x:Name="MyRotation3D" Angle="0" Axis="1,1,0"/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/RotateTransform3D.Rotation&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/RotateTransform3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Transform&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt"><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Material&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DiffuseMaterial&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DiffuseMaterial.Brush&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ImageBrush ImageSource="venus.jpg" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DiffuseMaterial.Brush&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DiffuseMaterial&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Material&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Model3DGroup.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Model3DGroup&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ModelVisual3D.Content&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ModelVisual3D&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Children&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Triggers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EventTrigger RoutedEvent="Viewport3D.Loaded"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EventTrigger.Actions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;BeginStoryboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Storyboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DoubleAnimation From="-45" To="45" Duration="0:0:12" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Storyboard.TargetName="MyRotation3D"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Storyboard.TargetProperty="Angle" RepeatBehavior="Forever" AutoReverse="True" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Storyboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/BeginStoryboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/EventTrigger.Actions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/EventTrigger&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Triggers&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&nbsp; &lt;/Viewport3D&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Grid&gt;</P>
<P class=MsoNormal style="MARGIN: 0in 0in 0pt">&lt;/Window&gt;<BR><BR><BR></o:p></SPAN><SPAN style="FONT-SIZE: 10pt; FONT-FAMILY: Verdana">It is&nbsp;available for download along with the original Mandelbrot sample <A href="http://www.strangelights.com/download.aspx?url=/blog/downloads/Mandlebrot.zip">here</A>.<o:p></o:p></SPAN></P>
