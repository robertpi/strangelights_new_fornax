---
title: "Bending the Cat: F# meets WPF 3D"
date: 2006-06-23T09:20:00.0000000
draft: false
---

<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana>I&#8217;ve been playing with F# and Windows Presentation Foundation (WPF a.k.a Avalon) and the combination is really nice. WPF comes with a new(ish) markup language called Xaml. This is another declarative language that works in a complimentary way to F#. Xaml allows you initialise an object graph into a specific state in a declarative style; moreover various designers will soon be come available to do this, so you won&#8217;t even have to hand code the Xaml file. You can then load the xaml file and use F# to tweak resulting images.<?xml:namespace prefix = o ns = "urn:schemas-microsoft-com:office:office" /><o:p></o:p></FONT></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><o:p><FONT face=Verdana>&nbsp;</FONT></o:p></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana>I have written a sample in which we create a 3D scene with one object, a photo, which rotates slowly though 180 degrees. The vast majority of this is written in Xaml, the only thing we do in F# is add the plane to scene and apply various effects to it.<o:p></o:p></FONT></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><o:p><FONT face=Verdana>&nbsp;</FONT></o:p></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana>Here are some of the resulting images; the rotation allows you to see the 3D effect clearly.<o:p></o:p></FONT></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><o:p><FONT face=Verdana>&nbsp;</FONT></o:p></SPAN></P>
<P><IMG src="/blog/photos/cat_cos1.jpg"><BR><IMG src="/blog/photos/cat_cos2.jpg"><BR><IMG src="/blog/photos/cat_random1.jpg"><BR><IMG src="/blog/photos/cat_random2.jpg"><BR><IMG src="/blog/photos/cat_random3.jpg"><BR><IMG src="/blog/photos/cat_waves1.jpg"><BR><IMG src="/blog/photos/cat_waves2.jpg"> </P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana>The code is downloadable <A href="http://www.strangelights.com/download.aspx?url=/blog/downloads/XamlCatPlane.zip">here</A>. Or can be seen below:</FONT></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana></FONT></SPAN>&nbsp;</P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Collections.Generic <BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.IO<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Controls<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Markup<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Media<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Windows.Media.Media3D<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">open</SPAN> System.Xml<BR><BR>#I <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"C:\Program Files\Reference Assemblies\Microsoft\WinFx\v3.0"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"PresentationCore.dll"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"PresentationFramework.dll"</SPAN> ;;<BR>#r <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">@"WindowsBase.dll"</SPAN> ;;<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// creates the window and loads given the Xaml file into it</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_window (file : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">string</SPAN>) = <BR>&nbsp;Idioms.using&nbsp; (XmlReader.Create(file))<BR>&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> stream -&gt; <BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> temp = XamlReader.Load(stream) :?&gt; Window <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;&nbsp;temp.Height &lt;- 400.0;<BR>&nbsp;&nbsp;temp.Width &lt;- 400.0;<BR>&nbsp;&nbsp;temp.Title &lt;- <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"F# meets Xaml"</SPAN><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;&nbsp;temp)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// finds all the MeshGeometry3D in a given 3D view port</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> find_meshes ( viewport : Viewport3D ) = <BR>&nbsp;viewport.Children&nbsp;<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> ModelVisual3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> c -&gt; Some(c.Content) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> Model3DGroup <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mg -&gt; Some(mg.Children) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.concat<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> GeometryModel3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mg -&gt; Some(mg.Geometry) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)<BR>&nbsp;|&gt; IEnumerable.choose (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">function</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">:?</SPAN> MeshGeometry3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">as</SPAN> mv -&gt; Some(mv) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">|</SPAN> _ -&gt; None)</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent"></SPAN></SPAN></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: black; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent"><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// loop function to create all items necessary for a plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_item_list f (x_res : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) (y_res : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> List&lt;_&gt;() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> x = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> x_res - 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> y = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> y_res - 1 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;&nbsp;f list x y<BR>&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;list<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// function to initalise a point</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> point x y = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point(x, y)<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// function to initalise a "d point</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> point3D x y = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D(x, y, 0.0)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create all the points necessary for a square in the plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_square f (x_step : float) (y_step : float) (list : List&lt;_&gt;) (x : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) (y : <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> x' =&nbsp; Float.of_int x * x_step <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> y' =&nbsp; Float.of_int y * y_step <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;list.Add(f x' y')<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) y')<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f (x' + x_step) (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f x' (y' + y_step))<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;list.Add(f x' y')<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create all items in a plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_points f x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> x_step = 1.0 / Float.of_int x_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> y_step = 1.0 / Float.of_int y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;create_plane_item_list (create_square f x_step y_step) x_res y_res<BR>&nbsp;<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create the 3D positions for a plane, i.e. the thing that says where</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// the plane will be in 3D space</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_positions x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = create_plane_points point3D x_res y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create the texture mappings for a plane, i.e. the thing that </SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// maps the 2D image to the 3D plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_plane_textures x_res y_res = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = create_plane_points point x_res y_res <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> PointCollection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create indices list fora ll our triangles&nbsp;</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> create_indices_plane width height = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> list = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> System.Collections.Generic.List&lt;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">int</SPAN>&gt;() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">for</SPAN> index = 0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">to</SPAN> width * height * 6 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;&nbsp;list.Add(index)<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">done</SPAN>;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Int32Collection(list)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// center the plane in the field of view</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_center (positions : Point3DCollection) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> new_positions = positions |&gt; IEnumerable.map&nbsp; <BR>&nbsp;&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> position -&gt; <BR>&nbsp;&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D((position.X - 0.5 ) * -1.0 <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">,</SPAN> (position.Y - 0.5 ) * -1.0, position.Z)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(new_positions)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create a plane and add it to the given mesh</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> add_plane_to_mesh (mesh : MeshGeometry3D) x_res y_res = <BR>&nbsp;mesh.Positions &lt;- map_positions_center (create_plane_positions x_res y_res)<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">;</SPAN><BR>&nbsp;mesh.TextureCoordinates &lt;- create_plane_textures x_res y_res;<BR>&nbsp;mesh.TriangleIndices &lt;- create_indices_plane x_res y_res<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// generic function for mapping Z plane relative to x y plane</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions f (positions : Point3DCollection) = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> new_positions = positions |&gt; IEnumerable.map&nbsp; <BR>&nbsp;&nbsp;(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> position -&gt; <BR>&nbsp;&nbsp;&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3D(position.X, position.Y, f position.X position.Y)) <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Point3DCollection(new_positions)<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the y coordiante</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_cos_y = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> _ y -&gt; Math.Cos(y * Math.PI))<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the x and y coordiantes</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_cos_xy = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> x y -&gt; Math.Cos(x * Math.PI) * Math.Cos(y * Math.PI))<BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's z coordiante using a cos wave of the x and y coordiantes, that </SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// has been scaled to give a rippled effect</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_waves = <BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> x y -&gt; (Math.Cos(x * Math.PI * 4.0) / 3.0) * (Math.Cos(y * Math.PI * 2.0) / 3.0)) <BR><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// map the plane's Z coordiante randomly</SPAN><BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> map_positions_random = <BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> rand = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Random() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;map_positions (<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">fun</SPAN> _ _ -&gt; rand.NextDouble() / 10.0) <BR><BR>[&lt;STAThread&gt;<STATHREAD>]<BR><SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">do</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// create our window</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> window = create_window <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"Window1.xaml"</SPAN> <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// grab the 3D view port</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> viewport = window.FindName(<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: red; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">"ViewPort"</SPAN>) :?&gt; Viewport3D <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// find all the meshes and get the first one</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> meshes = find_meshes viewport <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> mesh = IEnumerable.hd meshes <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// add plane to the mesh</SPAN><BR>&nbsp;add_plane_to_mesh mesh 20 20;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// apply a transformation to the plane</SPAN><BR>&nbsp;mesh.Positions &lt;- map_positions_waves mesh.Positions;<BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: green; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">// show the window</SPAN><BR>&nbsp;<SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">let</SPAN> app = <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">new</SPAN> Application() <SPAN style="FONT-WEIGHT: normal; FONT-SIZE: 11px; COLOR: blue; FONT-FAMILY: Lucida Console; BACKGROUND-COLOR: transparent">in</SPAN>&nbsp;<BR>&nbsp;app.Run(window) |&gt; ignore</SPAN></SPAN></P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><FONT face=Verdana></FONT></SPAN>&nbsp;</P>
<P class=NormalVerdana style="MARGIN: 0in 0in 0pt"><SPAN style="FONT-SIZE: 10pt"><o:p><FONT face=Verdana>
<HR id=null>
</FONT></o:p></SPAN>
<P></P>
<P><FONT face=Verdana size=2><WINDOW<BR><WINDOW<BR><WINDOW<BR>&lt;Window<BR>&nbsp;&nbsp;&nbsp; <BR>xmlns="<A href="http://schemas.microsoft.com/winfx/2006/xaml/presentation">http://schemas.microsoft.com/winfx/2006/xaml/presentation</A>"<BR>&nbsp;&nbsp;&nbsp; <BR>xmlns:x="<A href="http://schemas.microsoft.com/winfx/2006/xaml">http://schemas.microsoft.com/winfx/2006/xaml</A>"<BR>&nbsp;&nbsp;&nbsp; Title="RichContent"<BR>&nbsp;&nbsp;&nbsp; &gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp; &lt;Viewport3D Name="ViewPort"&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Camera&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;PerspectiveCamera Position="0,0,2" LookDirection="0,0,-1" FieldOfView="60" /&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Camera&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ModelVisual3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ModelVisual3D.Content&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Model3DGroup &gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Model3DGroup.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;AmbientLight Color="White" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Geometry&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;MeshGeometry3D /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Geometry&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Transform&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RotateTransform3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;RotateTransform3D.Rotation&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;AxisAngleRotation3D x:Name="MyRotation3D" Angle="45" Axis="0,1,0"/&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/RotateTransform3D.Rotation&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/RotateTransform3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Transform&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;GeometryModel3D.Material&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DiffuseMaterial&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DiffuseMaterial.Brush&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;ImageBrush ImageSource="venus.jpg" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DiffuseMaterial.Brush&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/DiffuseMaterial&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D.Material&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/GeometryModel3D&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Model3DGroup.Children&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Model3DGroup&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ModelVisual3D.Content&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/ModelVisual3D&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Children&gt;</FONT></P>
<P><FONT face=Verdana size=2>&nbsp;&nbsp;&nbsp; &lt;Viewport3D.Triggers&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EventTrigger RoutedEvent="Viewport3D.Loaded"&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;EventTrigger.Actions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;BeginStoryboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Storyboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;DoubleAnimation From="-90" To="90" Duration="0:0:12" <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Storyboard.TargetName="MyRotation3D"<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Storyboard.TargetProperty="Angle" RepeatBehavior="Forever" AutoReverse="True" /&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Storyboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/BeginStoryboard&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/EventTrigger.Actions&gt;<BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/EventTrigger&gt;<BR>&nbsp;&nbsp;&nbsp; &lt;/Viewport3D.Triggers&gt;<BR>&nbsp; &lt;/Viewport3D&gt;</FONT></P>
<P><FONT face=Verdana size=2>&lt;/Window&gt;<BR></FONT><FONT face=Verdana size=2></FONT></P>

### Feedback:

*Feedback was imported from my only blog engine, it's no longer possible to post feedback here.*

**re: Bending the Cat: F# meets WPF 3D - [Robert Pickering](http://strangelights.com/blog)**

I have updated the code in the artical and in the download to shorten the find_meshes function. I know use:<br><br>|&gt; IEnumerable.choose (function :? ModelVisual3D as c -&gt; Some(c.Content) | _ -&gt; None)<br>|&gt; IEnumerable.choose (function :? Model3DGroup as mg -&gt; Some(mg.Children) | _ -&gt; None)<br>|&gt; IEnumerable.concat<br>|&gt; IEnumerable.choose (function :? GeometryModel3D as mg -&gt; Some(x.Geometry) | _ -&gt; None)<br>|&gt; IEnumerable.choose (function :? MeshGeometry3D as mv -&gt; Some(mv) | _ -&gt; None)<br><br><br>Instead of<br><br>|&gt; IEnumerable.filter (fun child -&gt; (child :? ModelVisual3D))<br> |&gt; IEnumerable.map (fun x -&gt; (match x with | :? ModelVisual3D as mv -&gt; mv | _ -&gt; failwith &quot;won't happen&quot;))<br> |&gt; IEnumerable.filter (fun x -&gt; (x.Content :? Model3DGroup)) <br> |&gt; IEnumerable.map (fun x -&gt; match x.Content with | :? Model3DGroup as mg -&gt; mg | _ -&gt; failwith &quot;won't happen&quot; )<br> |&gt; IEnumerable.map (fun x -&gt; x.Children )<br> |&gt; IEnumerable.concat<br> |&gt; IEnumerable.filter (fun x -&gt; (x :? GeometryModel3D)) <br> |&gt; IEnumerable.map (fun x -&gt; match x with | :? GeometryModel3D as mv -&gt; mv | _ -&gt; failwith &quot;won't happen&quot; )<br> |&gt; IEnumerable.filter (fun x -&gt; (x.Geometry :? MeshGeometry3D)) <br> |&gt; IEnumerable.map (fun x -&gt; match x.Geometry with | :? MeshGeometry3D as mv -&gt; mv | _ -&gt; failwith &quot;won't happen&quot; )<br><br>Thanks to Don Syme for the suggestion

**re: Bending the Cat: F# meets WPF 3D - Alex Grenier**

Wow... pretty nice usage of some cutting edge stuff!<br />Do you have any tips on how can I get this to build and run under Orcas beta 2 after installing F# 1.9.2?<br />Cheers!

**re: Bending the Cat: F# meets WPF 3D - [Robert Pickering](http://strangelights.com/)**

Thanks!<br /><br />Yes you can find out how to fix F#/VS Orcas here:<br />http://gbarnett.org/archive/2007/08/03/how-to-get-f-working-on-vs-2008-beta-2.aspx

**re: Bending the Cat: F# meets WPF 3D - Alex Grenier**

Thanks!<br /><br />Once F# properly registered with Orcas, all I had to do is point to the 3.0 WPF assemblies on this Longhorn box. I suppose that's the path of 3.0 when bundled with the OS.<br /><br />So compile options become:<br /><br />-I "C:\Program Files\Reference Assemblies\Microsoft\Framework\v3.0" -r "PresentationCore.dll" -r "PresentationFramework.dll" -r "WindowsBase.dll"<br /><br />Instead of:<br /><br />-I "C:\Program Files\Reference Assemblies\Microsoft\WinFX\v3.0" -r "PresentationCore.dll" -r "PresentationFramework.dll" -r "WindowsBase.dll"<br /><br />

**re: Bending the Cat: F# meets WPF 3D - pocky**

good sample and if we need to load many xaml files to one scence, How can we do ?

